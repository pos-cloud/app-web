<section class="container-fluid">
  <div class="row container-filter">
    <div class="col-md-1">
      <label for="branch" class="control-label">
        <b>{{ 'agency' | translate | capitalize }}</b>
      </label>
      <select class="form-control" [(ngModel)]="branchSelectedId">
        <option [ngValue]="null" [disabled]="!allowChangeBranch">Todas</option>
        <option *ngFor="let branch of branches" [ngValue]="branch._id" [disabled]="!allowChangeBranch">
          {{ branch.number }} - {{ branch.name }}
        </option>
      </select>
    </div>
    <div class="col-md-2">
      <label for="transactionType" class="control-label">
        <b>Tipo de Transacción</b>
      </label>
      <ng-multiselect-dropdown
        [placeholder]="'Tipo de Transacción'"
        [settings]="dropdownSettings"
        [data]="transactionTypes"
        [(ngModel)]="transactionTypesSelect"
      >
      </ng-multiselect-dropdown>
    </div>
    <div class="col-md-1">
      <label for="startDate" class="control-label">
        <b>{{ 'startDate' | translate | capitalize }}:</b>
      </label>
      <input type="date" class="form-control" name="startDate" min="2000-01-01" [(ngModel)]="startDate" />
    </div>
    <div class="col-md-1">
      <label for="endDate" class="control-label">
        <b>{{ 'endDate' | translate | capitalize }}:</b>
      </label>
      <input type="date" class="form-control" name="endDate" min="2000-01-01" [(ngModel)]="endDate" />
    </div>
    <div class="col-md-1" (click)="getSalesByCategory()">
      <label for="action" class="control-label"> </label>
      <span class="form-control btn-action">
        <i [ngClass]="{ 'fa fa-refresh fa-spin': loading }"></i>{{ 'refresh' | translate | capitalize }}
      </span>
    </div>
  </div>
  <div class="card card-large">
    <div class="card-header">Categorías por {{ transactionMovement }}</div>
    <div class="card-block table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <ng-container *ngFor="let column of columns">
              <th>{{ column.label | translate | capitalize }}</th>
            </ng-container>
          </tr>
        </thead>

        <tbody>
          <tr *ngIf="loading">
            <td colspan="99" style="padding: 0px">
              <app-progressbar [loading]="loading"></app-progressbar>
            </td>
          </tr>

          <tr *ngFor="let item of data">
            <td *ngFor="let column of columns">
              {{ item[column.key] }}
            </td>
          </tr>

          <tr *ngIf="!data?.length && !loading">
            <td colspan="{{ columns?.length || 1 }}" class="text-center">
              {{ 'no data found' | translate | capitalize }}.
            </td>
          </tr>
        </tbody>

        <tfoot *ngIf="data?.length">
          <tr>
            <td *ngFor="let column of columns; let i = index">
              <strong *ngIf="i > 0 && totals[column.key] !== undefined">
                {{ totals[column.key] | number: '1.2-2' }}
              </strong>
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</section>
