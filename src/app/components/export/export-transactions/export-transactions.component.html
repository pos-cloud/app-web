<section class="container-fluid">
    <div class="modal-header">
      <h4 class="modal-title">Exportar Excel</h4>
      <button type="button" class="close" aria-label="Close" (click)="activeModal.dismiss('close_click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="center-content"  *ngIf="alertMessage !== ''">
      <ngb-alert [type]="alertConfig.type" [dismissible]="alertConfig.dismissible" (close)="alertMessage=''">
        {{alertMessage}}
      </ngb-alert>
    </div>
    <form [formGroup]="exportForm" #formExport="ngForm" (ngSubmit)="getTransactions()" autocomplete="off">
      <div class="modal-body">
        <div class = "row">
          <div class="form-group col-md-4">
            <label for="startDate" class="control-label">Desde:</label>
            <input type="date" class="form-control" formControlName="startDate" name="startDate" id="startDate"/>
            <div *ngIf="formErrors.startDate" class="alert alert-danger">
              {{ formErrors.startDate }}
            </div>
          </div>
          <div class="form-group col-md-4">
            <label for="endDate" class="control-label">Hasta:</label>
            <input type="date" class="form-control" formControlName="endDate" name="endDate" id="endDate"/>
            <div *ngIf="formErrors.endDate" class="alert alert-danger">
              {{ formErrors.endDate }}
            </div>
          </div>
          <div class="form-group col-md-4">
              <label for="branch" class="control-label">Sucursal</label>
                <select class="form-control" formControlName="branch">
                  <option [ngValue]="null" [disabled]="readonly"></option>
                  <option *ngFor="let branch of branches"         
                          [value]="branch._id">
                          {{branch.name}}</option>
                </select>
            </div>
        </div>
          <div class="row">
              <div class="form-group col-md-4">
                  <label for="company" class="control-label">Empresa</label>
                    <select class="form-control" formControlName="company">
                      <option [ngValue]="null" [disabled]="readonly"></option>
                      <option *ngFor="let company of companies"         
                              [value]="company._id">
                              {{company.name}}</option>
                    </select>
                </div>
                <div class="form-group col-md-4">
                    <label for="type" class="control-label">Tipo:</label>
                      <select class="form-control" formControlName="type">
                        <option [ngValue]="null" [disabled]="readonly"></option>
                        <option *ngFor="let type of types"         
                                [value]="type._id">
                                {{type.name}}</option>
                      </select>
                  </div>
                  <div class="form-group col-md-4">
                      <label for="employee" class="control-label">Empleado:</label>
                        <select class="form-control" formControlName="employee">
                          <option [ngValue]="null" [disabled]="readonly"></option>
                          <option *ngFor="let employee of employees"         
                                  [value]="employee._id">
                                  {{employee.name}}</option>
                        </select>
                    </div>
          </div>
          
        
      </div>
      <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="activeModal.close('cancel')">Cancelar</button>
          <button type="submit" class="btn btn-primary" [disabled]="!exportForm.valid || loading" >
            <i class="fa" [ngClass]="{'fa-save':!loading, 'fa-spinner fa-spin':loading}"></i>
            <span *ngIf="!loading">Exportar</span>
            <span *ngIf="loading">Espere por favor</span>
          </button>
      </div>
    </form>
  
  </section>